package io.geekidea.springboot.assembly.demo.Test;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONObject;
import com.google.common.collect.Lists;
import io.geekidea.springboot.assembly.demo.utils.ProcessUtils;
import lombok.extern.slf4j.Slf4j;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.stream.Collectors;

@Slf4j
public class Test_83 {
    public static void main(String[] args) {
        String ckRequestParam="[\"skuGoodCommentCnt\",\"l03SameDayExpressRateOrgin1163\",\"spuBestCjNum30d\",\"innerDealAmtRank\",\"spuBestSxRate15d\",\"l2WxInnerDealPermeateRateSpu\",\"spuBestCjNum7d\",\"spuBestSxRate30d\",\"innerOrdsPermeateRateRank\",\"l2BrandGmv31971\",\"spuBestCate3SearchConversionRankRate30d\",\"l2ItemDxDays31969\",\"spuInnerDealAmt\",\"l02Score31413\",\"spuBestCjNum15d\",\"beautyBuyingGiftBrand\",\"l02CommentNum30020\",\"skuGoodCommentRate\",\"l03ResponseSpeedOrgin1168\",\"spuInnerParentOrdQtty\",\"l02IsOverseaPurchase30216\",\"innerParentOrdQtty\",\"l03AfsDurationOrgin1162\",\"l03ScoreRankRate1182\",\"avgPrice\",\"virtualProductFlag\",\"innerItemUv\",\"cate3SearchConversionRankRate30d\",\"innerItemPermeateRateRank\",\"shopPopCoopModeCd\",\"skuD30SaleQtty\",\"spuBestGoodCommentRate\",\"innerItemUvRank\",\"spuBestSxRate7d\",\"isCShop\",\"shadowSkuFlag\",\"spuBestCate3SearchConversionRankRate15d\",\"l2PresaleStatus31997\",\"l2WxInnerDealAmtAfterDiscountSpu\",\"spuInnerOrdsPermeateRate\",\"itemSkuId\",\"spuBestGoodScoreLevelNumSum\",\"sxTrans7d\",\"cate3SearchConversionRankRate15d\",\"spuInnerItemPermeateRate\",\"cjNum7d\",\"innerDealAmt\",\"l2ItemGmvRatio31970\",\"innerParentOrdQttyRank\",\"l5LastLevel32100\",\"cjNum30d\",\"spuBestGoodScoreLevelNum\",\"spuItemQiGrade\",\"l2Discount31985\",\"l03TransDisputeRateOrgin1169\",\"plusIsQmxList\",\"l02IsJx30226\",\"brandLevelLabel\",\"spuInnerDealPermeateRate\",\"l2WxInnerParentOrdQttySpu\",\"l2WxInnerItemConverRateSpu\",\"dataType\",\"l02IsFreeShipping29513\",\"mainBrandCode\",\"InnerDealPermeateRateRank\",\"code77\",\"minPrice\",\"skuWechatCompetIndexRate\",\"skuItemQiGrade\",\"innerItemConverRate\",\"jdPrice\",\"sxTrans30d\",\"cateGmvRankRate30dSpu\",\"l2WxInnerOrdsPermeateRateSpu\",\"cate3SearchConversionRankRate7d\",\"lbsProductType\",\"skuD30BrandOrderRate\",\"innerItemConverRateRank\",\"l2WxInnerItemUvSpu\",\"skuName\",\"l03LLevel1179\",\"sxTrans15d\",\"l2WxInnerItemPermeateRateSpu\",\"l2Discount\",\"spuBestCate3SearchConversionRankRate7d\",\"innerDealPermeateRate\",\"categoryInfos\",\"spuInnerItemUv\",\"cjNum15d\",\"skuPromotActTmList\",\"innerItemPermeateRate\",\"spuInnerItemConverRate\",\"spuSumBestGoodCommentRate\",\"l2AolaiFlag31896\",\"deptInfo\",\"innerOrdsPermeateRate\",\"l2BrandRank31972\",\"l2Discount3031994\",\"spuBestCjNum30dSum\"]";
        List<String> ckColumnList =JSON.parseObject(ckRequestParam,List.class);

        String list="[{\"code\":\"l2Discount31985\",\"hint\":\"PLUS价格折扣力度=PLUS专享价/普惠红字价。其中，PLUS专享价来自PLUS促销商品信息和PLUS促销活动信息，即通过基础plus商品信息来对plus促销信息进行过滤，进而获取plus专享价格。普惠红字价的计算依赖交易提供的B端到手价，即过滤特殊非普惠的单品促销（PLUS价、学生价等）。\",\"name\":\"PLUS价折扣力度\"},{\"code\":\"skuPromotActTmList\",\"name\":\"PLUS权益指标\"},{\"code\":\"l2ItemGmvRatio31970\",\"hint\":\"该sku成交额订单中来源于PLUS用户的占比\",\"name\":\"PLUS会员销售额占比\"},{\"code\":\"plusIsQmxList\",\"name\":\"PLUS专享免息期数\"},{\"code\":\"innerItemUv\",\"hint\":\"微信域近N天商详UV 统计7天内，京购小程序内访问过商品详情页面的访客数\",\"name\":\"微信域近N天商详UV\"},{\"code\":\"innerItemUvRank\",\"hint\":\"三级类目微信域近N天商详UV排名率\",\"name\":\"三级类目微信域近N天商详UV排名率\"},{\"code\":\"innerItemPermeateRate\",\"hint\":\"微信域近N天商详UV渗透率\",\"name\":\"微信域近N天商详UV渗透率\"},{\"code\":\"innerItemPermeateRateRank\",\"hint\":\"三级类目微信域近N天商详UV渗透率排名率\",\"name\":\"三级类目微信域近N天商详UV渗透率排名率\"},{\"code\":\"innerItemConverRate\",\"hint\":\"微信域近N天商详转化率\",\"name\":\"微信域近N天商详转化率\"},{\"code\":\"innerItemConverRateRank\",\"hint\":\"三级类目微信域近N天商详转化率排名率\",\"name\":\"三级类目微信域近N天商详转化率排名率\"},{\"code\":\"innerParentOrdQtty\",\"hint\":\"微信域近N天成交父单量\",\"name\":\"微信域近N天成交父单量\"},{\"code\":\"innerParentOrdQttyRank\",\"hint\":\"三级类目微信域近N天成交父单量排名率\",\"name\":\"三级类目微信域近N天成交父单量排名率\"},{\"code\":\"innerOrdsPermeateRate\",\"hint\":\"微信域近N天成交父单量渗透率\",\"name\":\"微信域近N天成交父单量渗透率\"},{\"code\":\"innerOrdsPermeateRateRank\",\"hint\":\"三级类目微信域近N天成交父单量渗透率排名率\",\"name\":\"三级类目微信域近N天成交父单量渗透率排名率\"},{\"code\":\"innerDealAmt\",\"hint\":\"微信域近N天成交金额\",\"name\":\"微信域近N天成交金额\"},{\"code\":\"innerDealAmtRank\",\"hint\":\"三级类目微信域近N天成交金额排名率\",\"name\":\"三级类目微信域近N天成交金额排名率\"},{\"code\":\"innerDealPermeateRate\",\"hint\":\"微信域近N天成交金额渗透率\",\"name\":\"微信域近N天成交金额渗透率\"},{\"code\":\"InnerDealPermeateRateRank\",\"hint\":\"三级类目微信域近N天成交金额渗透率排名率\",\"name\":\"三级类目微信域近N天成交金额渗透率排名率\"},{\"code\":\"l02Score31413\",\"hint\":\"微信域竞争力指数\",\"name\":\"微信域竞争力指数\"},{\"code\":\"skuWechatCompetIndexRate\",\"hint\":\"微信域竞争力指数是综合评估商品微信域的转化效率、销量&amp;流量、微信域渗透率、价格力度等，判断商品在微信域的竞争力分值；排名率越靠前（率值越小），sku微信域竞争力越强；\",\"name\":\"微信域竞争力指数排名率\"},{\"code\":\"l2WxInnerItemUvSpu\",\"hint\":\"SPU下所有SKU的“微信域商详UV”加和\",\"name\":\"SPU维度-微信域近N天商详UV\"},{\"code\":\"l2WxInnerItemConverRateSpu\",\"hint\":\"SPU下所有SKU的“父单量加和“/SPU下所有SKU的“商详UV“加和\",\"name\":\"SPU维度-微信域近N天商详转化率\"},{\"code\":\"l2WxInnerParentOrdQttySpu\",\"hint\":\"SPU下所有SKU的“微信域成交父单量”加和\",\"name\":\"SPU维度-微信域近N天成交父单量\"},{\"code\":\"l2WxInnerDealAmtAfterDiscountSpu\",\"hint\":\"SPU下所有SKU的“微信域成交优惠后金额”加和\",\"name\":\"SPU维度-微信域近N天成交优惠后金额\"},{\"code\":\"l2WxInnerItemPermeateRateSpu\",\"hint\":\"SPU下所有SKU的微信域商详UV加和/SPU下所有SKU的零售大盘商详UV加和\",\"name\":\"SPU维度-微信域近N天商详UV渗透率\"},{\"code\":\"l2WxInnerOrdsPermeateRateSpu\",\"hint\":\"SPU下所有SKU的微信域成交父单量加和/SPU下所有SKU的零售大盘成交父单量加和\",\"name\":\"SPU维度-微信域近N天成交父单量渗透率\"},{\"code\":\"l2WxInnerDealPermeateRateSpu\",\"hint\":\"SPU下所有SKU的“微信域成交优惠后金额”加和/“零售大盘成交优惠后金额”加和\",\"name\":\"SPU维度-微信域近N天成交金额渗透率\"},{\"code\":\"isCShop\",\"name\":\"C店\"},{\"code\":\"brandLevelLabel\",\"name\":\"品牌分层\"},{\"code\":\"l2AolaiFlag31896\",\"hint\":\"勾选奥莱品牌id后，筛选出来的商品的品牌id为可报名的品牌id，更新频率为T+1\",\"name\":\"可报名奥莱品牌\"},{\"code\":\"l03LLevel1179\",\"hint\":\"含义同店铺分层，仅适用POP商家（含 FBP,FCS）,不包含拍拍二手、京喜、自有品牌、企业业务。L1 超级KA，店铺数量占行业总数的1%，L2 头部KA，店铺数量占行业总数的4%，L3 腰部主力，店铺数量占行业总数的15%，L4 潜力选拔,店铺数量占行业总数的20%，L5 尾部培育，店铺数量占行业总数的25%，L6 低活跃或刚开店新商家，店铺数量占行业总数的35%\",\"name\":\"商家分层\"},{\"code\":\"l03ResponseSpeedOrgin1168\",\"name\":\"咚咚响应时长\"},{\"code\":\"l03AfsDurationOrgin1162\",\"name\":\"售后处理时长\"},{\"code\":\"l03TransDisputeRateOrgin1169\",\"name\":\"近30天交易纠纷率\"},{\"code\":\"l03SameDayExpressRateOrgin1163\",\"name\":\"当日揽收率\"},{\"code\":\"l03ScoreRankRate1182\",\"hint\":\"标签值范围即[0,1]区间，如需勾选25%-100%，请选择0.25-1。\",\"name\":\"店铺星级排名率\"},{\"code\":\"shopPopCoopModeCd\",\"hint\":\"\",\"name\":\"店铺合作模式\"},{\"code\":\"deptInfo\",\"name\":\"部门\"},{\"code\":\"skuItemQiGrade\",\"hint\":\"综合消费者评论、退换修及客诉等多维度质量反馈数据，结合政府抽检、京东内部抽检、认证和检测等信息，构建大数据模型，对京东平台商品给出质量得分和排名，用来判断商品质量综合表现。商品将根据质量指数分为AA、A、B、C、D五个等级。\",\"name\":\"商品质量等级(SKU)\"},{\"code\":\"dataType\",\"name\":\"商品类型\"},{\"code\":\"l2PresaleStatus31997\",\"hint\":\"预售未开始：预售生效但预售活动未开始，如需剔除预热期可选此时期,预售进行中：【推荐使用】预售开始时触发，通常剔除预售类型即剔除定金期可选此时期,尾款进行中：尾款开始时触发,尾款结束：尾款结束时触发，代表整个预售真正结束。在校验预售是否重复建立应依据此状态判断\",\"name\":\"剔除商品预售状态\"},{\"code\":\"categoryInfos\",\"name\":\"类目\"},{\"code\":\"skuGoodCommentRate\",\"hint\":\"截止当前4-5星评论数 / 截止当前1-5星评论数，不含默认好评；为了避免无销量新品被过滤，默认值为1\",\"name\":\"当前好评率\"},{\"code\":\"skuGoodCommentCnt\",\"hint\":\"截止当前4-5星评论数，不含默认好评\",\"name\":\"当前好评数\"},{\"code\":\"spuItemQiGrade\",\"hint\":\"综合消费者评论、退换修及客诉等多维度质量反馈数据，结合政府抽检、京东内部抽检、认证和检测等信息，构建大数据模型，对京东平台商品给出质量得分和排名，用来判断商品质量综合表现。商品将根据质量指数分为AA、A、B、C、D五个等级。\",\"name\":\"商品质量等级(SPU)\"},{\"code\":\"l02IsFreeShipping29513\",\"hint\":\"是否任意地区包邮商品\",\"name\":\"是否包邮\"},{\"code\":\"l02IsJx30226\",\"name\":\"是否京喜\"},{\"code\":\"l02IsOverseaPurchase30216\",\"name\":\"是否全球购\"},{\"code\":\"shadowSkuFlag\",\"name\":\"是否影分身商品\"},{\"code\":\"virtualProductFlag\",\"name\":\"虚拟商品标识\"},{\"code\":\"mainBrandCode\",\"hint\":\"商品发布时所对应的品牌ID，支持多个ID同时输入，结果取并集\",\"name\":\"品牌名称（品牌id）\"},{\"code\":\"skuD30BrandOrderRate\",\"name\":\"品牌内商品近30天成交金额排名率\"},{\"code\":\"l2BrandRank31972\",\"hint\":\"SKU所属主品牌在这个SKU所属的三级类目下的销售排名：例如——该sku对应的主品牌，是三级类目下品牌成交金额排名TOP10的主品牌\",\"name\":\"所属品牌成交金额排名\"},{\"code\":\"l2BrandGmv31971\",\"hint\":\"SKU所属主品牌的近30天品牌成交金额绝对值，用于筛选大于主品牌成交额的商品：例如——该sku对应的主品牌，是近30天品牌成交金额大于10w的主品牌\",\"name\":\"所属品牌近30天成交金额\"},{\"code\":\"l02CommentNum30020\",\"hint\":\"有效评价，即非默认（一键好评的）评价,技术口径：content !='此用户未填写评价内容\",\"name\":\"有效评论数\"},{\"code\":\"l5LastLevel32100\",\"hint\":\"结合销售规模，用户规模，广告投放等多因子综合评价品牌在各类目下品牌力层级。以主品牌进行测算，结果分1-6个层级。\",\"name\":\"品牌力分层\"},{\"code\":\"beautyBuyingGiftBrand\",\"hint\":\"勾选该标签后，筛选出来的商品的品牌id为可报名的品牌id，更新频率为T+1\",\"name\":\"美妆高端买赠品牌\"},{\"code\":\"l2Discount\",\"hint\":\"平均成交价折扣力度=单品单价到手价/N天历史成交价\",\"name\":\"平均成交价折扣力度\"},{\"code\":\"l2Discount3031994\",\"hint\":\"折扣力度=单品单价到手价/30天历史成交价无单位\",\"name\":\"近30天平均成交价折扣力度\"},{\"code\":\"l2ItemDxDays31969\",\"hint\":\"近30天动销天数，如果有25天有成交，则该指标为25；商品池范围，近30天有动销的商品\",\"name\":\"SKU动销天数\"},{\"code\":\"cjNum7d\",\"hint\":\"商品前7天在全站的成交商品数量\",\"name\":\"近7天动销件数\"},{\"code\":\"cjNum15d\",\"hint\":\"商品前15天在全站的成交商品数量\",\"name\":\"近15天动销件数\"},{\"code\":\"cjNum30d\",\"hint\":\"商品前30天在全站的成交商品数量\",\"name\":\"近30天动销件数\"},{\"code\":\"sxTrans7d\",\"hint\":\"商详转化排名率=商品同三级类目转化率排名数/三级类目的总商品数，值越小效果越好\",\"name\":\"近7天商详转化排名率\"},{\"code\":\"sxTrans15d\",\"hint\":\"商详转化排名率=商品同三级类目转化率排名数/三级类目的总商品数，值越小效果越好\",\"name\":\"近15天商详转化排名率\"},{\"code\":\"sxTrans30d\",\"hint\":\"商详转化排名率=商品同三级类目转化率排名数/三级类目的总商品数，值越小效果越好\",\"name\":\"近30天商详转化排名率\"},{\"code\":\"cate3SearchConversionRankRate7d\",\"hint\":\"搜索转化排名率=商品同三级类目转化率排名数/三级类目的总商品数，值越小效果越好\",\"name\":\"近7日搜索转化排名率\"},{\"code\":\"cate3SearchConversionRankRate15d\",\"hint\":\"搜索转化排名率=商品同三级类目转化率排名数/三级类目的总商品数，值越小效果越好\",\"name\":\"近15日搜索转化排名率\"},{\"code\":\"cate3SearchConversionRankRate30d\",\"hint\":\"搜索转化排名率=商品同三级类目转化率排名数/三级类目的总商品数，值越小效果越好\",\"name\":\"近30日搜索转化排名率\"},{\"code\":\"code77\",\"hint\":\"标签生产范围是90天内有动销的商品，数值越小越好\",\"name\":\"成交金额排名率\"},{\"code\":\"skuD30SaleQtty\",\"name\":\"SKU近30天成交件数\"},{\"code\":\"avgPrice\",\"hint\":\"获取近N天普惠订单，筛选订单中使用的普惠促销、优惠券、套装，计算得到普惠订单成交价，进一步计算近N天平均成交价\",\"name\":\"近N天平均成交价\"},{\"code\":\"minPrice\",\"hint\":\"获取近N天普惠订单，筛选订单中使用的普惠促销、优惠券、套装，计算得到普惠订单成交价，进一步计算近N天历史最低价\",\"name\":\"SKU近N天历史普惠最低价\"},{\"code\":\"jdPrice\",\"hint\":\"京东基准价，维护时直接更新，与商品详情页展示的京东价可能不一致，例如商品有促销情况下则不一致，商品详情页展示的是实时京东价。\",\"name\":\"京东价\"},{\"code\":\"spuBestGoodCommentRate\",\"hint\":\"数据口径：spu下所有sku的好评率的最大值\",\"name\":\"当前好评率最大值-SPU\"},{\"code\":\"spuSumBestGoodCommentRate\",\"hint\":\"数据口径：spu下所有评价中好评数/spu下所有评价数。\",\"name\":\"当前好评率总和-SPU\"},{\"code\":\"spuBestGoodScoreLevelNum\",\"name\":\"当前好评数最大值-SPU\"},{\"code\":\"spuBestCjNum7d\",\"hint\":\"商品前7天在全站的成交商品数量\",\"name\":\"SPU近7天动销件数\"},{\"code\":\"spuBestCjNum15d\",\"hint\":\"商品前15天在全站的成交商品数量\",\"name\":\"SPU近15天动销件数\"},{\"code\":\"spuBestCjNum30d\",\"hint\":\"商品前30天在全站的成交商品数量\",\"name\":\"近30天动销件数最大值-SPU\"},{\"code\":\"spuBestSxRate7d\",\"hint\":\"商详转化排名率=商品同三级类目转化率排名数/三级类目的总商品数，值越小效果越好\",\"name\":\"SPU近7天商详转化排名率\"},{\"code\":\"spuBestSxRate15d\",\"hint\":\"商详转化排名率=商品同三级类目转化率排名数/三级类目的总商品数，值越小效果越好\",\"name\":\"SPU近15天商详转化排名率\"},{\"code\":\"spuBestSxRate30d\",\"hint\":\"商详转化排名率=商品同三级类目转化率排名数/三级类目的总商品数，值越小效果越好\",\"name\":\"SPU近30天商详转化排名率\"},{\"code\":\"spuBestCate3SearchConversionRankRate7d\",\"hint\":\"搜索转化排名率=商品同三级类目转化率排名数/三级类目的总商品数，值越小效果越好\",\"name\":\"SPU近7天搜索转化排名率\"},{\"code\":\"spuBestCate3SearchConversionRankRate15d\",\"hint\":\"搜索转化排名率=商品同三级类目转化率排名数/三级类目的总商品数，值越小效果越好\",\"name\":\"SPU近15天搜索转化排名率\"},{\"code\":\"spuBestCate3SearchConversionRankRate30d\",\"hint\":\"搜索转化排名率=商品同三级类目转化率排名数/三级类目的总商品数，值越小效果越好\",\"name\":\"SPU近30天搜索转化排名率\"},{\"code\":\"cateGmvRankRate30dSpu\",\"hint\":\"\",\"name\":\"SPU成交金额排名率\"},{\"code\":\"spuBestGoodScoreLevelNumSum\",\"name\":\"当前好评数总和-SPU\"},{\"code\":\"spuBestCjNum30dSum\",\"name\":\"近30天动销件数总和-SPU\"},{\"code\":\"spuInnerItemUv\",\"hint\":\"SPU微信域近N天商详UV\",\"name\":\"SPU微信域近N天商详UV\"},{\"code\":\"spuInnerItemConverRate\",\"hint\":\"SPU微信域近N天商详转化率\",\"name\":\"SPU微信域近N天商详转化率\"},{\"code\":\"spuInnerParentOrdQtty\",\"hint\":\"SPU微信域近N天成交父单量\",\"name\":\"SPU微信域近N天成交父单量\"},{\"code\":\"spuInnerDealAmt\",\"hint\":\"SPU微信域近N天成交优惠后金额\",\"name\":\"SPU微信域近N天成交优惠后金额\"},{\"code\":\"spuInnerItemPermeateRate\",\"hint\":\"SPU微信域近N天商详UV渗透率\",\"name\":\"SPU微信域近N天商详UV渗透率\"},{\"code\":\"spuInnerOrdsPermeateRate\",\"hint\":\"SPU微信域近N天成交父单量渗透率\",\"name\":\"SPU微信域近N天成交父单量渗透率\"},{\"code\":\"spuInnerDealPermeateRate\",\"hint\":\"SPU微信域近N天成交金额渗透率\",\"name\":\"SPU微信域近N天成交金额渗透率\"},{\"code\":\"lbsProductType\",\"name\":\"LBS商品类型\"},{\"code\":\"itemSkuId\",\"hint\":\"请用,分割，最多输入2000个\",\"name\":\"商品skuid（白名单）\"},{\"code\":\"itemSkuId\",\"hint\":\"最多可录入100个skuid\",\"name\":\"商品skuid（黑名单）\"},{\"code\":\"skuName\",\"hint\":\"根据关键词将商品名称中命中输入词的商品剔除\",\"name\":\"商品名称（黑名单）\"}]";
        List<Map<String,Object>> data = JSON.parseObject(list,List.class);
        log.info("getCodeByPoolType data: {} ",JSON.toJSONString(data));

        // 2、从ck表中找到对应的标签（下划线）
        Map<String, String> ckCodeMap = new HashMap<>();
        for (String ckColumn : ckColumnList) {
            String camelCode = ProcessUtils.underline2Camel(ckColumn);
            ckCodeMap.put(camelCode,ckColumn);
        }

        log.info("getCodeByPoolType ckCodeMap: {} ",JSON.toJSONString(ckCodeMap));
        // 转化后所有的ckcode转驼峰之后的code集合
        List<String> ckCodeList = ckCodeMap.keySet().stream().collect(Collectors.toList());

        // 3.ck表中匹配上了魔盒code
        Map<String, String> matchMap = new HashMap<>();
        // ck表中没有匹配上的code集合
        List<String> notMatchList = new ArrayList<>();

        for (Map<String, Object>  moheCodeMap: data) {
            String moheCode = (String) moheCodeMap.get("code");
            if(ckCodeList.contains(moheCode)){
                matchMap.put(moheCode,ckCodeMap.get(moheCode));
            }else{
                notMatchList.add(moheCode);
            }
        }

        // 4、返参
        Map<String, Object> resMap = new HashMap<>();
        resMap.put("matchMap",matchMap);
        resMap.put("notMatchList",notMatchList);
        System.out.println(resMap);

    }


}



